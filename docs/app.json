[{"name":"server.R","content":"library(shiny)\nlibrary(shinydashboard)\n# library(shinydashboardPlus)\nlibrary(Cairo)\noptions(shiny.usecairo = T)\nlibrary(kableExtra)\nlibrary(shinyBS)\n\nfunction(input, output, session) {\n  \n  ### CUSTOM URL FOR MENUITEM IN SIDEBARMENU\n  ### NOT WORK IN GITHUB PAGES!\n  \n  # observeEvent(getQueryString(session)$tab, {\n  #   currentQueryString <- getQueryString(session)$tab # alternative: parseQueryString(session$clientData$url_search)$tab\n  #   if(is.null(input$sidebarID) || !is.null(currentQueryString) && currentQueryString != input$sidebarID){\n  #     freezeReactiveValue(input, \"sidebarID\")\n  #     updateTabItems(session, \"sidebarID\", selected = currentQueryString)\n  #   }\n  # }, priority = 1)\n  # \n  # observeEvent(input$sidebarID, {\n  #   currentQueryString <- getQueryString(session)$tab # alternative: parseQueryString(session$clientData$url_search)$tab\n  #   pushQueryString <- paste0(\"?tab=\", input$sidebarID)\n  #   if(is.null(currentQueryString) || currentQueryString != input$sidebarID){\n  #     freezeReactiveValue(input, \"sidebarID\")\n  #     updateQueryString(pushQueryString, mode = \"push\", session)\n  #   }\n  # }, priority = 0)\n  \n  ### END CUSTOM URL FOR MENUITEM IN SIDEBARMENU\n  \n  output$user <- shinydashboardPlus::renderUser({\n    shinydashboardPlus::dashboardUser(\n      name = \"Daniel Franzani\",\n      image = \"https://raw.githubusercontent.com/Dfranzani/CV/refs/heads/main/Profile.jpeg\",\n      title = \"Ciencia de Datos\",\n      subtitle = \"\",\n      fluidRow(\n        shinydashboardPlus::dashboardUserItem(width = 6, shinydashboardPlus::socialButton(href = \"https://github.com/Dfranzani\", icon = icon(\"github-square\"))),\n        shinydashboardPlus::dashboardUserItem(width = 6, shinydashboardPlus::socialButton(href = \"https://dfranzani.github.io/website/principal/home.html\", icon = icon(\"blog\")))\n      )\n    )\n  })\n  \n  ### Distribuciones muestrales\n\n  histTCL = function(valores, media, desviacion, simulaciones){\n    medias = unlist(lapply(X = valores, FUN = mean))\n    factor = max(abs(media - c(min(medias), max(medias))))\n    lim_inf = media - factor; lim_sup = media + factor\n    grilla = seq(from = lim_inf, to = lim_sup, by = 0.001)\n    teoricos = dnorm(x = grilla, mean = media, sd = desviacion)\n    \n    densidad_medias = density(medias)\n    hist(x = medias, main = \"Distribución de las medias\", ylab = \"Función de densidad\",\n         xlab = \"Valores de la media en las simulaciones\", freq = FALSE, las = 1, breaks = round(1 + log2(simulaciones)),\n         xlim = c(lim_inf, lim_sup), ylim = c(0, max(densidad_medias$y, teoricos)*1.1))\n    lines(densidad_medias , col = \"darkred\")\n    lines(x = grilla, y = teoricos, col = \"darkblue\")\n    legend(\n      \"topright\", title = \"Distribución\", bty = \"n\",\n      legend = c(\"Aproximada \", paste0(\"Teórica - TCL: N(\", media, \", \", round(desviacion^2,5), \")\")),\n      lty = 1, col = c(\"darkred\", \"darkblue\")\n    )\n  }\n  \n  densidad_masa = function(x, valores, tipo, graph = \"p\"){\n    plot(x, valores, main = paste(\"Función de \", tipo, \" de probabilidad de \\n los datos muestrales simulados\"), bty = \"n\",\n         xlab = \"Valores de X\", ylab = \"\", las = 1, type = graph, pch = 16)\n  }\n  \n  plot_simulaciones = function(valores, dominio){\n    largo = length(valores[[1]])\n    cantidad = 4\n    datos = data.frame(\n      \"valores\" = unlist(valores[1:cantidad]),\n      \"dominio\" = rep(1:cantidad, rep(largo, cantidad))\n    )\n    boxplot(\n      datos$valores ~ datos$dominio, frame = F,\n      main = paste(\"Primeras \", cantidad, \" simulaciones\"),\n      xlab = \"Simulación\", ylab = \"Valores simulados\", xaxt = \"n\", yaxt = \"n\",\n      las = 1, pch = 16, ylim = c(min(datos$valores), max(datos$valores)*1.4)\n    )\n    axis(side = 1, at = 1:cantidad, labels = paste0(\"S\", 1:cantidad))\n    axis(side = 2, at = seq(from = min(datos$valores), to = max(datos$valores), length.out = 5),\n         labels = round(seq(from = min(datos$valores), to = max(datos$valores), length.out = 5)), las = 1)\n    legend(\n      \"top\", \n      legend = paste0(rep(\"S\", cantidad), 1:cantidad, rep(\": \", cantidad),\n                      unlist(lapply(X = valores[1: cantidad], FUN = function(x){return(round(mean(x), 4))}))),\n      bty = \"n\", title = \"Media de la simulación\", ncol = 2)\n  }\n\n  observeEvent(list(input$go_DM1, input$distribucionDM1),{\n    \n    n = input$nDM1\n    simulaciones = input$simulacionesDM1\n    \n    # set.seed(2024) # Bind cache\n    \n    if(input$distribucionDM1 == \"Normal\"){\n      media = input$mediaDM1_normal\n      sigma = sqrt(input$varianzaDM1_normal)\n      desviacion = sigma/sqrt(n)\n      valores = lapply(X = as.list(1:simulaciones), FUN = function(sim){\n        return(rnorm(n = n, mean = media, sd = sigma))\n      })\n      \n      output$Histograma_promedios = renderPlot({\n        histTCL(valores, media, desviacion, simulaciones)\n      })\n      \n      output$fdp_fmp_simulaciones = renderPlot({\n        medias = unlist(lapply(X = valores, FUN = mean))\n        factor = max(abs(media - c(min(medias), max(medias))))\n        lim_inf = media - factor; lim_sup = media + factor\n        grilla = seq(from = lim_inf, to = lim_sup, by = 0.001)\n        teoricos = dnorm(x = grilla, mean = media, sd = desviacion)\n        \n        par(mfrow = c(1,2))\n        plot_simulaciones(valores)\n        densidad_masa(x = grilla, valores = teoricos, tipo = \"densidad\", graph = \"l\")\n      })\n      \n    } else if(input$distribucionDM1 == \"Exponencial\"){\n      tasa = input$tasaDM1_exponencial\n      media = tasa\n      desviacion = sqrt(tasa^2/n)\n      \n      valores = lapply(X = as.list(1:simulaciones), FUN = function(sim){\n        return(rexp(n = n, rate = 1/tasa))\n      })\n      \n      output$Histograma_promedios = renderPlot({\n        histTCL(valores, media, desviacion, simulaciones)\n      })\n      \n      output$fdp_fmp_simulaciones = renderPlot({\n        teoricos = dexp(seq(from = 0, to = 30, by = 0.001), rate = 1/tasa)\n        par(mfrow = c(1,2))\n        plot_simulaciones(valores)\n        densidad_masa(x = seq(from = 0, to = 30, by = 0.001), valores = teoricos, tipo = \"densidad\", graph = \"l\")\n      })\n      \n    } else if(input$distribucionDM1 == \"Binomial\") {\n      ensayos = input$nDM1_binomial\n      p = input$pDM1_binomial\n      media = ensayos*p\n      desviacion = sqrt(ensayos*p*(1-p)/n)\n      \n      valores = lapply(X = as.list(1:simulaciones), FUN = function(sim){\n        return(rbinom(n = n, size = ensayos, prob = p))\n      })\n\n      output$Histograma_promedios = renderPlot({\n        histTCL(valores, media, desviacion, simulaciones)\n      })\n      \n      output$fdp_fmp_simulaciones = renderPlot({\n        teoricos = dbinom(x = 0:ensayos, size = ensayos, prob = p)\n        par(mfrow = c(1,2))\n        plot_simulaciones(valores)\n        densidad_masa(x = 0:ensayos, valores = teoricos,, tipo = \"masa\")\n      })\n      \n    } else if(input$distribucionDM1 == \"Poisson\"){\n      tasa = input$tasaDM1_poisson\n      media = tasa\n      desviacion = sqrt(tasa/n)\n      \n      valores = lapply(X = as.list(1:simulaciones), FUN = function(sim){\n        return(rpois(n = n, lambda = tasa))\n      })\n      \n      output$Histograma_promedios = renderPlot({\n        histTCL(valores, media, desviacion, simulaciones)\n      })\n      \n      output$fdp_fmp_simulaciones = renderPlot({\n        teoricos = dpois(x = 0:30, lambda = tasa)\n        par(mfrow = c(1,2))\n        plot_simulaciones(valores)\n        densidad_masa(x = 0:30, valores = teoricos, tipo = \"masa\")\n      })\n    }\n  })\n  \n  ### Intervalos de confianza\n  \n  hist_muestra_IC = function(x, y = NULL, nombre_media = nombre_media, control_lanzamiento = FALSE, colores){\n    \n    color = ifelse(\"red\" %in% colores, \"red\", \"grey\")\n    \n    if(nombre_media == \"Una\") {\n      titulo = ifelse(control_lanzamiento, \"Distribución de los datos de \\n la muestra del último IC\",\n                      paste(\"Distribución de los datos de la muestra \\n del IC número\", punto_seleccionado()))\n      hist(x, main = titulo, xlab = \"Valores de la muestra\", ylab = \"Frecuencia\", las = 1, col = color)\n    } else {\n      titulo = ifelse(control_lanzamiento, \"Distribuciones de los datos \\n de las muestras del último IC\",\n                      paste(\"Distribuciones de los datos de las muestras \\n del IC número\", punto_seleccionado()))\n      par(mfrow = c(2,1))\n      h1 = hist(x)\n      h2 = hist(y)\n      par(mar = c(0,5,3,3))\n      plot(h1, col = color, xlim = c(min(h1$breaks, h2$breaks), max(h1$breaks, h2$breaks)), ylim = c(0, max(h1$counts, h2$counts)),\n           las = 1, ylab = \"Frecuencias de X\", xaxt = \"n\", main = titulo)\n      par(mar = c(5,5,0,3))\n      plot(h2, col = color, xlim = c(min(h1$breaks, h2$breaks), max(h1$breaks, h2$breaks)), ylim = c(max(h1$counts, h2$counts), 0),\n           las = 1, main = \"\", ylab = \"Frecuencias de Y\", xlab = \"Valores de la muestra\")\n    }\n  }\n  \n  hist_medias_IC = function(x, nombre_media = nombre_media){\n    if(nombre_media == \"Una\") {\n      hist(x, main = \"Distribución de las medias muestrales\", xlab = \"Valores de la muestra\",\n           ylab = \"Frecuencia\", las = 1)\n    } else {\n      hist(x, main = \"Distribución de las diferencias \\n de las medias muestrales (X-Y)\", xlab = \"Valores de la muestra\",\n           ylab = \"Frecuencia\", las = 1)\n    }\n  }\n  \n  simulaciones_muestras = function(nombre_media = nombre_media){\n    muestras = lapply(X = as.list(1:input$simulacionesIC), FUN = function(sim){\n      if(nombre_media == \"Una\") {\n        data1 = rnorm(n = input$nIC, mean = input$muIC, sd = sqrt(input$sigma2IC))\n      } else {\n        data1 = rnorm(n = input$nICX, mean = input$muICX, sd = sqrt(input$varianzaUnaMediaX))\n        data2 = rnorm(n = input$nICY, mean = input$muICY, sd = sqrt(input$varianzaUnaMediaY))\n        data1 = list(\"data1\" = data1, \"data2\" = data2)\n      }\n      return(data1)\n    })\n    return(muestras)\n  }\n  \n  calculo_IC = function(data1, data2 = NULL, tipo, varianzas_conocidas, tipo_varianzas = FALSE, extremos,\n                        confianza, varianza = NA, varianzaX = NA, varianzaY = NA, tamanos_muestrales = NA, media = media){\n   \n    if(varianzas_conocidas == FALSE){\n      limites = t.test(x = data1, y = data2, conf.level = confianza, alternative = tipo, var.equal = tipo_varianzas)$conf.int[extremos]  \n    } else {\n      if (is.null(data2)) {\n        if(tipo == \"two.sided\") {\n          limites = mean(data1) + c(-1,1)*qnorm(1 - (1- confianza)/2)*sqrt(varianza/tamanos_muestrales[1])\n        } else if(tipo == \"less\") {\n          limites = mean(data1) + qnorm(confianza)*sqrt(varianza/tamanos_muestrales[1])\n        } else {\n          limites = mean(data1) - qnorm(confianza)*sqrt(varianza/tamanos_muestrales[1])\n        }\n      } else {\n        if(tipo == \"two.sided\") {\n          limites = c(mean(data1) - mean(data2) - qnorm(1 - (1- confianza)/2)*sqrt(varianzaX/tamanos_muestrales[1] + varianzaY/tamanos_muestrales[2]),\n                      mean(data1) - mean(data2) + qnorm(1 - (1 - confianza)/2)*sqrt(varianzaX/tamanos_muestrales[1] + varianzaY/tamanos_muestrales[2]))\n        } else if(tipo == \"less\") {\n          limites = mean(data1) - mean(data2) + qnorm(confianza)*sqrt(varianzaX/tamanos_muestrales[1] + varianzaY/tamanos_muestrales[2])\n        } else {\n          limites = mean(data1) - mean(data2) - qnorm(confianza)*sqrt(varianzaX/tamanos_muestrales[1] + varianzaY/tamanos_muestrales[2])\n        }\n      }\n    }\n    \n    if(tipo == \"greater\") {\n      limites = c(limites, limites[1] + 0.5*sqrt(varianza))\n      colores = c(ifelse(limites[1] > media, \"red\", \"black\"), \"white\")\n    } else if(tipo == \"less\") {\n      limites = c(limites[1] - 0.5*sqrt(varianza), limites)\n      colores = c(\"white\", ifelse(limites[2] < media, \"red\", \"black\"))\n    } else {\n      colores = rep(ifelse(limites[1] < media & limites[2] > media, \"black\", \"red\"), 2)\n    }\n    return(c(limites, colores))\n  }\n  \n  grafico_IC = function(x, y, colores, limites_x, simulaciones, media, nombre_media, tipoIC){\n    plot(\n      x = x, y = 1:simulaciones, col = colores[,1], pch = 16, las = 1, bty = \"n\",\n      ylim = c(1, simulaciones + 5), xlim = limites_x, xaxt = \"n\", yaxt = \"n\",\n      xlab = \"Valores del IC\", ylab = \"Número de simulación\",\n      main = ifelse(nombre_media == \"Una\",\n                    \"IC para la media proveniente \\n de una distribución normal\",\n                    \"IC para la diferencia de medias (X-Y) \\n provenientes de distribuciones normales\")\n    )\n    axis(side = 1, at = c(limites_x[1], media, limites_x[2]), labels = c(limites_x[1], media, limites_x[2]), xlim = limites_x)\n    axis(side = 2, at = round(seq(from = 1, to = simulaciones, length.out = 10), 0), las = 1)\n    points(x = y, y = 1:simulaciones, pch = 16, col = colores[,2])\n    if(tipoIC == \"less\"){\n      arrows(x1 = x, x0 = y, y1 = 1:simulaciones, y0 = 1:simulaciones, length = 0.07, col = colores[,2])\n      rojos = round(sum(colores[,2] == \"red\")/length(colores[,2])*100, digits = 2)\n      negros = 100 - rojos\n    } else if(tipoIC == \"greater\") {\n      arrows(x0 = x, x1 = y, y0 = 1:simulaciones, y1 = 1:simulaciones, length = 0.07, col = colores[,1])\n      rojos = round(sum(colores[,1] == \"red\")/length(colores[,2])*100, digits = 2)\n      negros = 100 - rojos\n    } else {\n      segments(x0 = x, x1 = y, y0 = 1:simulaciones, y1 = 1:simulaciones, col = colores[,1])\n      rojos = round(sum(colores[,1] == \"red\")/length(colores[,1])*100, digits = 2)\n      negros = 100 - rojos\n    }\n    rojos = paste(rojos, \"%\")\n    negros = paste(negros, \"%\")\n    # abline(v = media, col = \"black\", lty = 2)\n    segments(x0 = media, y0 = 0, x1 = media, y1 = simulaciones+1, lty = 2)\n    legend(\"topleft\", legend = c(negros, rojos), lty = 1, col = c(\"black\", \"red\"), title = \"Proporción de IC\", bty = \"n\")\n  }\n  \n  IC = function(tipo_varianzas, tipoIC, extremos, confianza, varianza, varianzaX = NA, varianzaY = NA,\n                tamanos_muestrales, media = media, nombre_media = nombre_media){\n    muestras_simuladas = simulaciones_muestras(nombre_media = nombre_media)\n    ics = lapply(X = muestras_simuladas, FUN = function(muestra){\n      if(input$VarianzasIC != \"Conocidas\") {\n        if(input$MediasIC == \"Una\") {\n          ic = calculo_IC(data1 = muestra, tipo = tipoIC, varianzas_conocidas = FALSE, varianza = varianza,\n                          extremos = extremos, confianza = confianza, media = media)\n        } else {\n          ic = calculo_IC(data1 = muestra$data1, data2 = muestra$data2, tipo = tipoIC, varianzas_conocidas = FALSE,\n                          tipo_varianzas = tipo_varianzas, extremos = extremos, confianza = confianza, media = media,\n                          varianza = varianza,)\n        }\n      } else {\n        if(input$MediasIC == \"Una\") {\n          ic = calculo_IC(data1 = muestra, tipo = tipoIC, varianzas_conocidas = TRUE, tipo_varianzas = tipo_varianzas,\n                          extremos = extremos, confianza = confianza, varianza = varianza, tamanos_muestrales = tamanos_muestrales,\n                          media = media)\n        } else {\n          ic = calculo_IC(data1 = muestra$data1, data2 = muestra$data2, tipo = tipoIC, varianzas_conocidas = TRUE,\n                          tipo_varianzas = tipo_varianzas, extremos = extremos, confianza = confianza, varianza = varianza,\n                          varianzaX = varianzaX, varianzaY = varianzaY, tamanos_muestrales = tamanos_muestrales, media = media)\n        }\n      }\n      return(ic)\n    })\n    ics = as.data.frame(matrix(unlist(ics), ncol = 4, byrow = TRUE))\n    ics[,1] = as.numeric(ics[,1])\n    ics[,2] = as.numeric(ics[,2])\n    return(list(ics, muestras_simuladas))\n  }\n  \n  muestras = NULL\n  ic = NULL\n  nombre_media_global = NULL\n  simulaciones_global = NULL\n  \n  observeEvent(list(input$go_IC),{\n    confianza = input$ConfianzaIC/100\n    simulaciones = input$simulacionesIC\n    simulaciones_global <<- simulaciones\n    media = ifelse(input$MediasIC == \"Una\", input$muIC, input$muICX - input$muICY)\n    tipoIC = switch(input$tipoIC, \"Bilateral\" = \"two.sided\", \"Acotado por la derecha\" = \"less\", \"Acotado por la izquierda\" = \"greater\")\n    extremos = switch(tipoIC, \"two.sided\" = 1:2, \"less\" = 2, \"greater\" = 1)\n    varianza = ifelse(input$MediasIC == \"Una\", input$sigma2IC, (input$varianzaUnaMediaX + input$varianzaUnaMediaY)/2)\n    tipo_varianzas = switch(input$VarianzasICMedias, \"Iguales\" = TRUE, \"Distintas\" = FALSE)\n    nombre_media = ifelse(input$MediasIC == \"Una\", \"Una\", \"Dos\")\n    nombre_media_global <<- nombre_media\n    varianzaX = input$varianzaUnaMediaX\n    varianzaY = input$varianzaUnaMediaY\n    tamanos_muestrales = c(input$nIC, input$nICX, input$nICY)\n    \n    ic_y_muestras = IC(tipo_varianzas = tipo_varianzas, tipoIC = tipoIC, extremos = extremos, confianza = confianza,\n                       varianza = varianza, varianzaX = varianzaX, varianzaY = varianzaY,\n                       tamanos_muestrales = tamanos_muestrales, media = media, nombre_media = nombre_media)\n    ic <<- ic_y_muestras[[1]]\n    muestras <<- ic_y_muestras[[2]]\n    \n    dif_maxima = max(abs(c(media - c(ic[,1], ic[,2]))))\n    maximo = round(media + 1.5*dif_maxima, digits = 4)\n    minimo = round(media - 1.5*dif_maxima, digits = 4)\n    \n    output$plot_ic = renderPlot({\n      grafico_IC(x = ic[,1], y = ic[,2], colores = ic[,3:4], limites_x = c(minimo, maximo),\n                 simulaciones = simulaciones, media = media, nombre_media = nombre_media, tipoIC = tipoIC)\n    }, height = 800)\n    \n    punto_seleccionado(NULL)\n    output$histogramaIC = renderPlot({\n      if(nombre_media == \"Una\"){\n        hist_muestra_IC(x = muestras[[simulaciones]], nombre_media = nombre_media,\n                        control_lanzamiento = TRUE, colores = ic[simulaciones,3:4])\n      } else {\n        hist_muestra_IC(x = muestras[[simulaciones]]$data1, y = muestras[[simulaciones]]$data2,\n                        nombre_media = nombre_media, control_lanzamiento = TRUE, colores = ic[simulaciones,3:4])\n      }\n    })\n    \n    output$histograma_medias_IC = renderPlot({\n      if(nombre_media == \"Una\"){\n        hist_medias_IC(x = unlist(lapply(X = muestras, FUN = mean)), nombre_media = nombre_media)\n      } else {\n        hist_medias_IC(\n          x = unlist(lapply(X = muestras, FUN = function(muestra){\n            return(mean(muestra$data1) - mean(muestra$data2))\n          })),\n          nombre_media = nombre_media)\n      }\n    })\n  })\n  \n  punto_seleccionado = reactiveVal(NULL)\n  \n  observeEvent(input$plot_click, {\n    click_y = input$plot_click$y\n    punto_seleccionado(round(click_y))\n    if(punto_seleccionado() >= 1 & punto_seleccionado() <= simulaciones_global){\n      output$histogramaIC = renderPlot({\n        if(nombre_media_global == \"Una\"){\n          hist_muestra_IC(x = muestras[[punto_seleccionado()]], nombre_media = nombre_media_global,\n                          control_lanzamiento = FALSE, colores = ic[punto_seleccionado(), 3:4])\n        } else {\n          hist_muestra_IC(x = muestras[[punto_seleccionado()]]$data1, y = muestras[[punto_seleccionado()]]$data2,\n                          nombre_media = nombre_media_global, control_lanzamiento = FALSE, colores = ic[punto_seleccionado(), 3:4])\n        }\n      })\n    } else {\n      output$histogramaIC = renderPlot({\n        if(nombre_media_global == \"Una\"){\n          hist_muestra_IC(x = muestras[[simulaciones_global]], nombre_media = nombre_media_global,\n                          control_lanzamiento = TRUE, colores = ic[simulaciones_global, 3:4])\n        } else {\n          hist_muestra_IC(x = muestras[[simulaciones_global]]$data1, y = muestras[[simulaciones_global]]$data2,\n                           nombre_media = nombre_media_global, control_lanzamiento = TRUE, colores = ic[simulaciones_global, 3:4])\n        }\n      })\n    }\n  })\n  \n \n  addPopover(session, id = \"plot_ic\", trigger = \"hover\", placement = \"left\",\n             content = \"Haga click en un IC (o cerca) para ver la distribución de los datos muestrales asociados.\",\n             title = \"\")\n  \n  ### Pruebas de hipótesis\n  \n  grafico_estadisticoPrueba = function(ic, mediaMuestra, varianza, mu0, tipoPH, nMuestra, est_prueba, valor_critico, confianza){\n    \n    max = max(abs(c(0 - c(est_prueba, valor_critico, 4))))\n    limites = c(0 - max * 1.2, 0 + max * 1.2)\n    \n    # print(c(limites, est_prueba, valor_critico, max))\n    \n    valores_x = seq(from = limites[1], to = limites[2], by = 0.01)\n    valores_x = c(valores_x, est_prueba, valor_critico, -est_prueba, -valor_critico)\n    valores_x = valores_x[order(valores_x)]\n    \n    plot(x = valores_x, y = dnorm(x = valores_x),\n         main = \"Distribución del estadístico de prueba\", xlab = \"Valores de Z\", ylab = \"Densidad\",\n         las = 1, xaxt = \"n\", type = \"l\", bty = \"n\", xlim = limites, ylim = c(0, 0.5))\n    axis(side = 1, at = c(limites[1], 0, limites[2]),\n         labels = round(c(limites[1], 0, limites[2]), 2), cex.axis = 1, las = 1)\n    \n    if(tipoPH == \"two.sided\") {\n      axis(side = 1, at = c(-abs(est_prueba), abs(est_prueba)), labels = round(c(-abs(est_prueba), abs(est_prueba)), 2),\n           col.axis = \"red\", cex.axis = 1, las = 1)\n      axis(side = 1, at = c(-abs(valor_critico), abs(valor_critico)), labels = round(c(-abs(valor_critico), abs(valor_critico)), 2),\n           col.axis = \"blue\", cex.axis = 1, las = 1)\n      polygon(x = c(-abs(valor_critico), valores_x[valores_x <= -abs(valor_critico)]),\n              y = c(min(dnorm(x = valores_x[valores_x <= -abs(valor_critico)])), dnorm(x = valores_x[valores_x <= -abs(valor_critico)])),\n              lty = 2, density = 5, col = \"blue\")\n      polygon(x = c(-abs(est_prueba), valores_x[valores_x <= -abs(est_prueba)]),\n              y = c(min(dnorm(x = valores_x[valores_x <= -abs(est_prueba)])), dnorm(x = valores_x[valores_x <= -abs(est_prueba)])),\n              lty = 2, density = 5, col = \"red\", angle = 135)\n      polygon(x = c(abs(valor_critico), valores_x[valores_x >= abs(valor_critico)]),\n              y = c(min(dnorm(x = valores_x[valores_x >= abs(valor_critico)])), dnorm(x = valores_x[valores_x >= abs(valor_critico)])),\n              lty = 2, density = 5, col = \"blue\")\n      polygon(x = c(abs(est_prueba), valores_x[valores_x >= abs(est_prueba)]),\n              y = c(min(dnorm(x = valores_x[valores_x >= abs(est_prueba)])), dnorm(x = valores_x[valores_x >= abs(est_prueba)])),\n              lty = 2, density = 5, col = \"red\", angle = 135)\n      valor_p = 2 - 2*pnorm(abs(est_prueba))\n    } else if(tipoPH == \"less\") {\n      axis(side = 1, at = c(est_prueba), labels = round(c(est_prueba), 2),\n           col.axis = \"red\", cex.axis = 1, las = 1)\n      axis(side = 1, at = c(valor_critico), labels = round(c(valor_critico), 2),\n           col.axis = \"blue\", cex.axis = 1, las = 1)\n      polygon(x = c(valor_critico, valores_x[valores_x <= valor_critico]),\n              y = c(min(dnorm(x = valores_x[valores_x <= valor_critico])), dnorm(x = valores_x[valores_x <= valor_critico])),\n              lty = 2, density = 5, col = \"blue\")\n      polygon(x = c(est_prueba, valores_x[valores_x <= est_prueba]),\n              y = c(min(dnorm(x = valores_x[valores_x <= est_prueba])), dnorm(x = valores_x[valores_x <= est_prueba])),\n              lty = 2, density = 5, col = \"red\", angle = 135)\n      valor_p = pnorm(est_prueba)\n    } else {\n      axis(side = 1, at = c(est_prueba), labels = round(c(est_prueba), 2),\n           col.axis = \"red\", cex.axis = 1, las = 1)\n      axis(side = 1, at = c(valor_critico), labels = round(c(valor_critico), 2),\n           col.axis = \"blue\", cex.axis = 1, las = 1)\n      polygon(x = c(valor_critico, valores_x[valores_x >= valor_critico]),\n              y = c(min(dnorm(x = valores_x[valores_x >= valor_critico])), dnorm(x = valores_x[valores_x >= valor_critico])),\n              lty = 2, density = 5, col = \"blue\")\n      polygon(x = c(est_prueba, valores_x[valores_x >= est_prueba]),\n              y = c(min(dnorm(x = valores_x[valores_x >= est_prueba])), dnorm(x = valores_x[valores_x >= est_prueba])),\n              lty = 2, density = 5, col = \"red\", angle = 135)\n      valor_p = 1 - pnorm(est_prueba)\n    }\n    \n    valor_p2 = ifelse(valor_p < 0.0001, \"<1e-4\", round(valor_p, digits = 4))\n    significancia = format((1 - confianza))\n    legend(\"topright\", legend = paste(c(\"Valor-p:\", \"Significancia:\"), c(valor_p2, significancia)), bty = \"n\",\n           lty = 2, col = c(\"red\", \"blue\"))\n    legend(\"topleft\", legend = ifelse(valor_p  <= 1 - confianza, \"Se rechaza\", \"No se rechaza\"), bty = \"n\",\n           title = \"Estado:\", text.font = 4)\n  }\n  \n  grafico_IC_PH = function(ic, mediaMuestra, varianza, mu0, tipoPH, nMuestra, est_prueba, valor_critico, confianza){\n    \n    max = max(abs(c(0 - c(est_prueba, valor_critico, 4))))\n    limites = c(0 - max * 1.2, 0 + max * 1.2)\n    \n    valores_x = seq(from = limites[1], to = limites[2], by = 0.01)\n    valores_x = c(valores_x, est_prueba, valor_critico, -est_prueba, -valor_critico)\n    valores_x = valores_x[order(valores_x)]\n    valores_y = dnorm(x = valores_x)\n    \n    transformacion = function(x.barra){\n      return((x.barra - mu0)/sqrt(varianza/nMuestra))\n    }\n    \n    transformacion_inversa = function(Z0){\n      return(mu0 + Z0*sqrt(varianza/nMuestra))\n    }\n    \n    plot(x = valores_x, y = valores_y,\n         main = \"Distribución de la media muestral \\n e intervalo de confianza\", xlab = \"Valores del promedio\", ylab = \"Densidad\",\n         las = 1, xaxt = \"n\", type = \"l\", bty = \"n\", xlim = limites, ylim = c(0, 0.5))\n    axis(side = 1, at = c(limites[1], 0, limites[2]),\n         labels = round(transformacion_inversa(c(limites[1], 0, limites[2])), 4), cex.axis = 1, las = 1)\n    segments(x0 = 0, x1 = 0, y0 = 0, y1 = max(valores_y), col = \"black\", lty = 2)\n    \n    ic = as.numeric(ic[1:2])\n    ic2 = transformacion(as.numeric(ic[1:2]))\n    max_y = max(valores_y)*0.5\n    \n    if(tipoPH == \"two.sided\") {\n      segments(x0 = ic2[1], x1 = ic2[2], y0 = max_y, y1 = max_y, col = \"red\", lty = 2)\n      legend(\"topleft\", legend = paste0(\"(\", round(ic[1], 4), \", \", round(ic[2], 4), \")\"),\n             bty = \"n\", title = \"IC\", lty = 2, col = \"red\")\n    } else if(tipoPH == \"less\") {\n      arrows(x1 = limites[1], x0 = ic2[2], y0 = max_y, y1 = max_y, length = 0.1, col = \"red\", lty = 2)\n      legend(\"topleft\", legend = paste0(\"(-Inf, \", round(ic[2], 4), \")\"),\n             bty = \"n\", title = \"IC\", lty = 2, col = \"red\")\n    } else {\n      arrows(x0 = ic2[1], x1 = limites[2], y0 = max_y, y1 = max_y, length = 0.1, col = \"red\", lty = 2)\n      legend(\"topleft\", legend = paste0(\"(\", round(ic[1], 4), \", Inf)\"),\n             bty = \"n\", title = \"IC\", lty = 2, col = \"red\")\n    }\n    legend(\"topright\", legend = mu0, bty = \"n\", title = \"mu_0\", lty = 2)\n  }\n  \n  valor_critico = function(confianza, tipo, mu0, varianza, nMuestra, mediaMuestra){\n    if(tipo == \"two.sided\") {\n      valor_critico = qnorm(1 - (1 - confianza)/2)\n    } else if(tipo == \"less\") {\n      valor_critico = qnorm(1 - confianza)\n    } else {\n      valor_critico = qnorm(confianza)\n    }\n    estadistico_prueba = (mediaMuestra - mu0)/(sqrt(varianza/nMuestra))\n    return(c(estadistico_prueba, valor_critico))\n  }\n  \n  observeEvent(list(input$go_PH), {\n    confianza = input$confianzaPH/100\n    mu0 = input$mu0PH\n    mediaMuestra = input$mediaMuestraPH\n    tipoPH = switch(input$tipoPH, \"Bilateral\" = \"two.sided\", \"Unilateral derecha\" = \"greater\", \"Unilateral izquierda\" = \"less\")\n    extremos = switch(tipoPH, \"two.sided\" = 1:2, \"less\" = 2, \"greater\" = 1)\n    varianza = input$sigma2PH\n    nombre_media = \"Una\"\n    nMuestra = input$nPH\n    \n    # Los argumentos data debe ser el promedio n veces para que calce con el cálculo del IC de la función \"calculo_IC\"\n    ic = calculo_IC(data1 = rep(mediaMuestra, nMuestra), tipo = tipoPH, varianzas_conocidas = TRUE, varianza = varianza,\n                    extremos = extremos, confianza = confianza, media = mediaMuestra, tamanos_muestrales = nMuestra)\n    \n    valor_critico = valor_critico(confianza = confianza, tipo = tipoPH, mu0 = mu0, varianza = varianza,\n    nMuestra = nMuestra, mediaMuestra = mediaMuestra)\n      \n    output$plot_ph = renderPlot({\n      grafico_estadisticoPrueba(ic = ic, media = mediaMuestra, varianza = varianza, mu0 = mu0, tipoPH = tipoPH, nMuestra = nMuestra,\n                    est_prueba = valor_critico[1], valor_critico = valor_critico[2], confianza = confianza)\n    }, height = 400)\n    \n    output$plot_ic_ph = renderPlot({\n      grafico_IC_PH(ic = ic, media = mediaMuestra, varianza = varianza, mu0 = mu0, tipoPH = tipoPH, nMuestra = nMuestra,\n                    est_prueba = valor_critico[1], valor_critico = valor_critico[2], confianza = confianza)\n    }, height = 400)\n    \n  })\n  \n  addPopover(session, id = \"plot_ic_ph\", trigger = \"hover\", placement = \"left\",\n             content = \"Se rechaza la hipótesis nula cuando la línea roja punteada (IC) intersecta la línea vertical negra punteada (media bajo hipótesis nula).\",\n             title = \"\")\n  \n  ### Regresión Lineal (Simple)\n  \n  regresion = function(x, y){\n    modelo = lm(y ~ x)\n    return(modelo)\n  }\n  \n  grafico_RL = function(x, y, modelo){\n    betas = modelo$coefficients\n    confidence_values = predict.lm(modelo, interval = \"confidence\")\n    prediction_values = predict.lm(modelo, newdata = data.frame(\"x\" = x, \"y\" = y), interval = \"prediction\")\n    y_confidence = confidence_values[order(confidence_values[,1]), 2:3]\n    y_prediction = prediction_values[order(prediction_values[,1]), 2:3]\n    plot(x = x, y = y, las = 1, bty = \"n\",\n         main = \"Regresión Lineal Simple\", xlab = \"Valores de X\", ylab = \"Valores de Y\",\n         ylim = c(min(c(y, y_confidence, y_prediction)), max(c(y, y_confidence, y_prediction))))\n    segments(x0 = min(x), x1 = max(x), y0 = betas[1] + betas[2]*min(x), y1 = betas[1] + betas[2]*max(x), col = \"red\", lty = 1)\n    lines(x = x[order(x)], y = y_confidence[,1], col = \"blue\", lty = 2)\n    lines(x = x[order(x)], y = y_confidence[,2], col = \"blue\", lty = 2)\n    lines(x = x[order(x)], y = y_prediction[,1], col = \"darkgreen\" ,lty = 2)\n    lines(x = x[order(x)], y = y_prediction[,2], col = \"darkgreen\", lty = 2)\n    legend(\"topleft\", legend = c(\"Recta de regresión ajustada\", \"IC del 95% para la media\", \"IC del 95% para la predicción\"),\n           lty = c(1, 2, 2), col = c(\"red\", \"blue\", \"darkgreen\"), bty = \"n\")\n  }\n  \n  grafico_supuestos = function(x, y, modelo){\n    par(mfrow = c(2,2), bty = \"n\", las = 1)\n    plot(x = modelo$fitted.values, y = residuals(modelo),\n         main = \"Linealidad\", xlab = \"Valores ajustados\", ylab = \"Residuos\")\n    acf(residuals(modelo),\n        main = \"Independenica \\n (Función de Autocorrelación: ACF)\", xlab = \"Lag\", ylab = \"ACF\")\n    plot(x = modelo$fitted.values, y = sqrt(abs(rstandard(modelo))),\n         main = \"Homocedasticidad\", xlab = \"Valores ajustados\", ylab = \"Raíz de los residuos estandarizados\")\n    qqnorm(modelo$residuals, main = \"Normalidad \\n (Cuantil - Cuantil)\", xlab = \"Cuantiles teóricos\", ylab = \"Cuantiles observados\")\n    qqline(modelo$residuals)\n  }\n  \n  violacion_supuestos = function(x, y){\n    \n    aux_y = y\n    aux_x = x\n    \n    if(!is.null(input$violacionSupuestos)){\n      \n      if (\"Linealidad\" %in% input$violacionSupuestos){\n        y = y + (x/70)^3\n      }\n      \n      if (\"Independencia\" %in% input$violacionSupuestos ){\n        y = apply(X = as.matrix(cbind(seq(from = 0, to = 45, length.out = length(y)), y)), MARGIN = 1, FUN = function(fila){\n          recorrido =  sin(fila[1])*200 + fila[2]\n          return(recorrido)\n        })\n      } \n      \n      if (\"Homocedasticidad\" %in% input$violacionSupuestos){\n        incrementos = cumsum(seq(from = 0.8, to = 1.2, length.out = length(y)))\n        y = abs(y*incrementos - max(y)/2)\n      }\n      \n      if (\"Normalidad\" %in% input$violacionSupuestos){\n        n_min = y[order(y)][8]\n        n_max = y[order(y)][(length(y)-8)]\n        y[y <= n_min] = y[y <= n_min] - y[y == n_max]*0.5\n        y[y >= n_max] = y[y >= n_max] + y[y == n_max]*0.5\n      } \n    }\n    return(y)\n  }\n  \n  observeEvent(list(input$go_RL), {\n    \n    set.seed(2024)\n    desviacion_simulacion = 100\n    x_poblacion = seq(from = 1, to = input$nPoblacionalRLS, by = 1)\n    y_poblacion = apply(X = as.matrix(x_poblacion + 100), MARGIN = 1, FUN = function(media){\n      return(rnorm(n = 1, mean = media, sd = desviacion_simulacion))\n    })\n    \n    n_muestra = sample(x = 1:input$nPoblacionalRLS, size = input$nMuestralRLS, replace = FALSE)\n    x_muestral = x_poblacion[n_muestra]\n    y_muestral = y_poblacion[n_muestra]\n    y_muestral = violacion_supuestos(x = x_muestral, y = y_muestral)\n    RL = regresion(x = x_muestral, y = y_muestral)\n    \n    output$plot_rl = renderPlot({\n      grafico_RL(x = x_muestral, y = y_muestral, modelo = RL)\n    })\n    \n    output$plot_supuestos = renderPlot({\n      grafico_supuestos(x = x_muestral, y = y_muestral, modelo = RL)\n    })\n    \n    output$resumen_rl = function(){\n      summary_RL = round(summary(RL)$coefficients, digits = 4)\n      summary_RL = ifelse(summary_RL == 0, \"<2e-16\", summary_RL)\n      rownames(summary_RL) <- c(\"β<sub>0<\/sub>\", \"β<sub>1<\/sub>\")\n      kableExtra::kbl(summary_RL, escape = FALSE, booktabs = T, align = \"c\",\n            caption = \"Resumen del modelo de regresión lineal\",\n            col.names = c(\"Estimación\", \"Error estándar\", \"Estadístico de prueba t\", \"Valor-p\")) |>\n        kableExtra::kable_styling(full_width = TRUE, bootstrap_options = c(\"condensed\", \"striped\"))\n    }\n    \n    output$resumen_rl_metricas = function(){\n      summary_RL = summary(RL)\n      metrics = round(unlist(summary_RL[c(\"fstatistic\", \"sigma\", \"r.squared\", \"adj.r.squared\")])[c(1,4:6)], digits = 4)\n      kableExtra::kbl(t(as.matrix(metrics)), escape = FALSE, booktabs = T, align = \"c\",\n        col.names = c(\"Estadístico F<sub>0<\/sub>\", \"Error estándar residual\", \"R<sup>2<\/sup>\", \"R<sup>2<\/sup> ajustado\")) |>\n        kableExtra::kable_styling(full_width = TRUE, bootstrap_options = c(\"condensed\", \"striped\"))\n    }\n\n    output$resumen_supuestos = function(){\n      \n      tests = list(\n        lmtest::bptest(formula = formula(RL), data = data.frame(\"x\" = x_muestral, \"y\" = y_muestral)),\n        lmtest::dwtest(formula = formula(RL), data = data.frame(\"x\" = x_muestral, \"y\" = y_muestral), alternative = \"two.sided\"),\n        shapiro.test(x = rstandard(RL))\n      ) |> lapply(FUN = function(test){\n        valor_p = round(test$p.value, digits = 4)\n        statistic = round(test$statistic, digits = 4)\n        valor_p = ifelse(valor_p < 0.0001, \"<1e-4\", valor_p)\n        statistic = ifelse(statistic < 0.0001, \"<1e-4\", statistic)\n        return(c(statistic, valor_p))\n      }) |> unlist() |> matrix(ncol = 2, byrow = TRUE) |> data.frame() |> setNames(c(\"Estadístico\", \"Valor-p\"))\n      \n      \n      tests$Prueba = c(\"Breusch-Pagan\", \"Durbin-Watson\", \"Shapiro-Wilk\")\n      tests$Supuesto = c(\"Homocedasticidad\", \"Independencia\", \"Normalidad\")\n      tests = tests[, c(\"Supuesto\", \"Prueba\", \"Estadístico\", \"Valor-p\")]\n      \n      kableExtra::kbl(tests, escape = FALSE, booktabs = T, align = \"c\",\n        caption = \"Prueba de hipótesis de los supuestos del modelo de regresión lineal\") |>\n        kableExtra::kable_styling(full_width = TRUE, bootstrap_options = c(\"condensed\", \"striped\"))\n    }\n\n  })\n  \n  addPopover(session = session, id = \"resumen_supuestos\", trigger = \"hover\", placement = \"bottom\",\n             content = \"Es posible que la violación de un determinado supuesto influya en otro. Revise el caso de violación del supuesto de homocedasticidad únicamente.\",\n             title = \"\") \n  \n# End general function  \n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","type":"text"},{"name":"ui.R","content":"library(shiny)\nlibrary(shinydashboard)\n# library(shinydashboardPlus1)\nlibrary(Cairo)\noptions(shiny.usecairo = T)\nlibrary(kableExtra)\nlibrary(shinyBS)\n\n# Encabezado general\n\nencabezado = dashboardHeader(title = \"Estadística\",\n                             tags$li(class = \"dropdown\",\n                                     tags$a(href = \"https://github.com/Dfranzani/App_Estadistica/discussions\", icon(\"comments\"), \"Comentarios y sugerencias\", target = \"_blank\")),\n                             shinydashboardPlus::userOutput(\"user\"))\n\n# Panel lateral general: filtro de temas\n\npanelLateral = dashboardSidebar(\n  collapsed = FALSE,\n  sidebarMenu(\n    id = \"sidebarID\",\n    menuItem(\"Teorema Central del Límite\", tabName = \"DM1\"),\n    menuItem(\"IC: Intervalos de confianza\", tabName = \"IC\"),\n    menuItem(\"Pruebas de Hipótesis\", tabName = \"PH\"),\n    menuItem(\"Regresión Lineal\", tabName = \"RL\")\n  )\n)\n\n# Paneles: cuerpo de cada panel del Panel lateral\n# Un cuerpo se puede volver a dividir en otro tipo de Layout\n\nsimulador = actionButton(inputId = \"go_DM1\", label = \"Simular\")\n\ncuerpo_DM1 = sidebarLayout(\n  sidebarPanel(\n    width = 3,\n    selectInput(inputId = \"distribucionDM1\", label = \"Distribución\", choices = c(\"Normal\", \"Exponencial\", \"Binomial\", \"Poisson\")),\n    conditionalPanel(\n      condition = \"input.distribucionDM1 == 'Normal'\",\n      sliderInput(inputId = \"mediaDM1_normal\", label = \"Media poblacional\", min = 0, max = 20, value = 12, step = 0.2),\n      sliderInput(inputId = \"varianzaDM1_normal\", label = \"Varianza poblacional\", min = 0, max = 20, value = 2, step = 0.1),\n    ),\n    conditionalPanel(\n      condition = \"input.distribucionDM1 == 'Binomial'\",\n      sliderInput(inputId = \"nDM1_binomial\", label = \"Ensayos\", min = 1, max = 100, value = 12, step = 1),\n      sliderInput(inputId = \"pDM1_binomial\", label = \"Probabilidad de éxito\", min = 0, max = 1, value = 0.4, step = 0.05),\n    ),\n    conditionalPanel(\n      condition = \"input.distribucionDM1 == 'Exponencial'\",\n      sliderInput(inputId = \"tasaDM1_exponencial\", label = \"Tasa\", min = 0, max = 20, value = 5, step = 0.1)\n    ),\n    conditionalPanel(\n      condition = \"input.distribucionDM1 == 'Poisson'\",\n      sliderInput(inputId = \"tasaDM1_poisson\", label = \"Tasa\", min = 0, max = 20, value = 8, step = 0.1)\n    ),\n    sliderInput(inputId = \"nDM1\", label = \"Tamaño muestral\", min = 100, max = 1000, value = 200, step = 50),\n    sliderInput(inputId = \"simulacionesDM1\", label = \"Cantidad de simulaciones\", min = 100, max = 7000, value = 1300, step = 100),\n    simulador, br(), br(),\n    a(\"Nota: para mayor información consulte el siguiente documento.\", href = \"https://dfranzani.github.io/Estadistica_I/distribuciones-muestrales.html#teorema-del-l%C3%ADmite-central\")\n  ),\n  mainPanel(\n    width = 9,\n    plotOutput(\"Histograma_promedios\"), plotOutput(\"fdp_fmp_simulaciones\")\n  )\n)\n\nsimulador2 = actionButton(inputId = \"go_IC\", label = \"Simular\")\n\ncuerpo_IC = sidebarLayout(\n  sidebarPanel(\n    width = 3,\n    fluidRow(\n      column(width = 4, radioButtons(inputId = \"MediasIC\", label = \"Medias\", choices = c(\"Una\", \"Dos\"))),\n      column(width = 8, radioButtons(inputId = \"VarianzasIC\", label = \"Varianzas\", choices = c(\"Conocidas\", \"Desconocidas\")))\n    ),\n    conditionalPanel(\n      condition = \"input.VarianzasIC == 'Desconocidas' && input.MediasIC == 'Dos'\",\n      radioButtons(inputId = \"VarianzasICMedias\", label = \"Varianzas desconocidas\", choices = c(\"Iguales\", \"Distintas\"))\n    ),\n    sliderInput(inputId = \"ConfianzaIC\", label = \"% Confianza\", min = 10, max = 99, value = 90, step = 1),\n    radioButtons(inputId = \"tipoIC\", label = \"Tipo de IC\", choices = c(\"Bilateral\", \"Acotado por la derecha\", \"Acotado por la izquierda\")),\n    conditionalPanel(\n      condition = \"input.MediasIC == 'Una'\",\n      sliderInput(inputId = \"muIC\", label = \"Media poblacional\", min = -20, max = 20, value = 0, step = 0.1),\n      sliderInput(inputId = \"sigma2IC\", label = \"Varianza poblacional\", min = 5, max = 30, value = 10, step = 0.1),\n      sliderInput(inputId = \"nIC\", label = \"Tamaño muestral\", min = 10, max = 200, value = 120, step = 10)\n    ),\n    conditionalPanel(\n      condition = \"input.MediasIC == 'Dos'\",\n      fluidRow(\n        column(width = 6, sliderInput(inputId = \"muICX\", label = \"Media poblacional X\", min = -10, max = 10, value = 0, step = 0.5)),\n        column(width = 6, sliderInput(inputId = \"muICY\", label = \"Media poblacional Y\", min = -10, max = 10, value = 7, step = 0.5))\n      ),\n      fluidRow(\n        column(width = 6, sliderInput(inputId = \"varianzaUnaMediaX\", label = \"Varianza poblacional X\", min = 10, max = 25, value = 12, step = 0.5)),\n        column(width = 6, sliderInput(inputId = \"varianzaUnaMediaY\", label = \"Varianza poblacional Y\", min = 10, max = 25, value = 16, step = 0.5))\n      ),\n      fluidRow(\n        column(width = 6, sliderInput(inputId = \"nICX\", label = \"Tamaño muestral X\", min = 50, max = 150, value = 120, step = 10)),\n        column(width = 6, sliderInput(inputId = \"nICY\", label = \"Tamaño muestral Y\", min = 50, max = 150, value = 80, step = 10))\n      ),\n    ),\n    sliderInput(inputId = \"simulacionesIC\", label = \"Cantidad de simulaciones\", min = 10, max = 100, value = 60, step = 1),\n    simulador2, br(), br(),\n    a(\"Nota: para mayor información consulte el siguiente documento.\", href = \"https://dfranzani.github.io/Estadistica_II/intervalos-de-confianza.html\")\n  ),\n  mainPanel(\n    width = 9,\n    fluidRow(\n      column(width = 6, plotOutput(\"plot_ic\", click = \"plot_click\", height = \"800px\")),\n      column(width = 6, plotOutput(\"histogramaIC\"), plotOutput(\"histograma_medias_IC\"))\n    )\n  )\n)\n\nsimulador3 = actionButton(inputId = \"go_PH\", label = \"Simular\")\n\ncuerpo_PH = sidebarLayout(\n  sidebarPanel(\n    width = 3,\n    radioButtons(inputId = \"mediasPH\", label = \"Medias\", choices = c(\"Una\")),#, \"Dos\")),\n    radioButtons(inputId = \"varianazasPH\", label = \"Varianzas\", choices = c(\"Conocidas\")),#, \"Desconocidas\")),\n    radioButtons(inputId = \"tipoPH\", label = \"Tipo de prueba\", choices = c(\"Bilateral\", \"Unilateral derecha\", \"Unilateral izquierda\")),\n    sliderInput(inputId = \"mu0PH\", label = \"Media bajo Hipótesis nula\", min = -2, max = 2, value = 0, step = 0.02),\n    sliderInput(inputId = \"sigma2PH\", label = \"Varianza poblacional\", min = 1, max = 50, value = 10, step = 0.5),\n    sliderInput(inputId = \"mediaMuestraPH\", label = \"Media muestral\", min = -2, max = 2, value = 0.6, step = 0.02),\n    sliderInput(inputId = \"nPH\", label = \"Tamaño muestral\", min = 10, max = 200, value = 120, step = 10),\n    sliderInput(inputId = \"confianzaPH\", label = \"% Confianza\", min = 10, max = 99, value = 87, step = 1),\n    simulador3, br(), br(),\n    a(\"Nota: para mayor información consulte el siguiente documento.\", href = \"https://dfranzani.github.io/Estadistica_II/PH.html\")\n  ),\n  mainPanel(\n    width = 9,\n    fluidRow(\n      column(width = 12, plotOutput(\"plot_ph\"), plotOutput(\"plot_ic_ph\"))\n    )#,\n    # fluidRow(\n    #   column(width = 6, withMathJax(includeMarkdown(\"Regresion+Lineal/Prueba.md\")))\n    # )\n  )\n)\n\nsimulador4 = actionButton(inputId = \"go_RL\", label = \"Simular\")\ncuerpo_RL = sidebarLayout(\n  sidebarPanel(\n    width = 2,\n    radioButtons(inputId = \"tipoRL\", label = \"Tipo de regresión\", choices = c(\"Simple\")),\n    # radioButtons(inputId = \"tipoRL\", label = \"Tipo de regresión\", choices = c(\"Simple\", \"Múltiple\")),\n    conditionalPanel(\n      condition = \"input.tipoRL == 'Simple'\",\n      sliderInput(inputId = \"nPoblacionalRLS\", label = \"Tamaño poblacional\", min = 600, max = 800, value = 700, step = 10),\n      sliderInput(inputId = \"nMuestralRLS\", label = \"Tamaño muestral\",  min = 100, max = 550, value = 240, step = 10)\n    ),\n    checkboxGroupInput(inputId = \"violacionSupuestos\", label = \"Violación de supuestos\",\n                       choices = c(\"Linealidad\", \"Normalidad\", \"Homocedasticidad\", \"Independencia\")),\n    simulador4, br(), br(),\n    a(\"Nota: para mayor información consulte el siguiente documento.\", href = \"https://dfranzani.github.io/Estadistica_II/regresi%C3%B3n-lineal.html#regresi%C3%B3n-lineal-simple\")\n  ),\n  mainPanel(\n    width = 10,\n    fluidRow(\n      column(width = 6, plotOutput(\"plot_rl\", height = \"500px\"), br(), tableOutput(\"resumen_rl\"), tableOutput(\"resumen_rl_metricas\")),\n      column(width = 6, plotOutput(\"plot_supuestos\", height = \"500px\"), br(), tableOutput(\"resumen_supuestos\"))\n    )\n  )\n)\n\nhover_load_BS_package = bsPopover(id = \"Histograma_promedios\", trigger = \"hover\", placement = \"left\",\n                                   content = \"La función Aproximada corresponde a la función de densidad que generan los promedios muestrales simulados, la cual, se compara con la función de densidad Teórica.\",\n                                   title = \"\")\n\n# Asignando los cuerpos por filtro\nhoja_DM = tabItem(tabName = \"DM1\", fluidPage(cuerpo_DM1), hover_load_BS_package)\nhoja_IC = tabItem(tabName = \"IC\", fluidPage(cuerpo_IC))\nhoja_PH = tabItem(tabName = \"PH\", fluidPage(cuerpo_PH))\nhoja_RL = tabItem(tabName = \"RL\", fluidPage(cuerpo_RL))\n\ncuerpo = dashboardBody(\n  tabItems(hoja_DM, hoja_IC, hoja_PH, hoja_RL)\n)\n\n# Despliegue general\nui = dashboardPage(header = encabezado, sidebar = panelLateral, body = cuerpo, skin = \"black\")\n\n\n","type":"text"},{"name":"Regresion+Lineal/Prueba.md","content":"# Probando elementos de inscrustación\n\n$$\nA + B = C\n$$\n\n1. Hola\n\n2. CHao\n\n**HOLA**S","type":"text"}]
